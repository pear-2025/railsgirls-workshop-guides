<div id="<%= dom_id idea %>" class="list-group-item list-group-item-action d-flex gap-3 py-3" style="<%= "background-color: #{idea.deadline_color}" if idea.deadline_color %>">
  <div class="d-flex flex-column gap-2 w-100">
    <h2><%= link_to idea.name, idea_path(idea) %></h2>
    <p><%= idea.description %></p>
    <% if idea.date.present? || idea.subject.present? || idea.submission_method.present? %>
      <p>
        <% if idea.date.present? %>
          <strong>提出日:</strong> <%= idea.date %><br>
        <% end %>
        <% if idea.subject.present? %>
          <strong>科目:</strong> <%= idea.subject %><br>
        <% end %>
        <% if idea.submission_method.present? %>
          <strong>提出方法:</strong>
          <% submission = idea.submission_method %>
          <% if submission =~ /\Ahttps?:\/\//i %>
            <%= link_to submission, submission, target: "_blank", rel: "noopener" %>
          <% else %>
            <%= submission %>
          <% end %>
        <% end %>
        <strong>提出状態:</strong> <span id="submission-status-<%= idea.id %>"><%= idea.submission == 1 ? "提出済み ✓" : "未提出" %></span>
        <% if idea.submission == 1 %>
          <button class="btn btn-sm btn-warning idea-submission-btn" data-idea-id="<%= idea.id %>" data-action="cancel">
            提出を取り消す
          </button>
        <% else %>
          <button class="btn btn-sm btn-success idea-submission-btn" data-idea-id="<%= idea.id %>" data-action="submit">
            提出完了
          </button>
        <% end %>
        <% if idea.date.present? %>
          <br>
          <% remaining_days = (idea.date - Date.today).to_i %>
          <small class="<%= remaining_days < 0 ? 'text-danger' : remaining_days <= 3 ? 'text-warning' : 'text-muted' %>">
            <strong>残り日数:</strong>
            <% if remaining_days < 0 %>
              期限切れ（<%= remaining_days.abs %>日前）
            <% elsif remaining_days == 0 %>
              本日が提出期限
            <% else %>
              あと<%= remaining_days %>日
            <% end %>
          </small>
        <% end %>

        <% if idea.tag_list.any? %>
          <br>
          <strong>タグ:</strong>
          <% idea.tag_list.each do |tag| %>
            <% unless tag.blank? %>
              <span class="badge bg-info text-dark"><%= tag.strip %></span>
            <% end %>
          <% end %>
        <% end %>
      </p>
    <% end %>
    <small class="opacity-50 text-nowrap">Last updated <%= time_ago_in_words idea.updated_at %></small>
  </div>
  <%= image_tag(idea.picture_url(:thumb), width: 150, height: 150, class: "img-thumbnail flex-shrink-0") if idea.picture? %>
</div>
